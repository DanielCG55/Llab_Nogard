(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))o(t);new MutationObserver(t=>{for(const n of t)if(n.type==="childList")for(const c of n.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&o(c)}).observe(document,{childList:!0,subtree:!0});function s(t){const n={};return t.integrity&&(n.integrity=t.integrity),t.referrerpolicy&&(n.referrerPolicy=t.referrerpolicy),t.crossorigin==="use-credentials"?n.credentials="include":t.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function o(t){if(t.ep)return;t.ep=!0;const n=s(t);fetch(t.href,n)}})();class h{constructor(e={x:0,y:0}){this.position=e}update(e){}draw(e,s){}keyboardEventDown(e){}keyboardEventUp(e){}}const f="src/assets/sounds/";class x extends h{constructor(){super({x:0,y:0}),this.music=new Audio,this.music.src=f+"backgroundMusic.mp3",this.music.volume=0,this.music.loop=!0,this.music.autoplay=!1}update(e){this.music.autoplay=!0,this.music.play()}}const k=(i,e)=>Math.sqrt(Math.pow(i.x-e.x,2)+Math.pow(i.y-e.y,2)),C="src/assets/img/";class T extends h{constructor(e){super(e.position),this.touched=!1,this.thouching=!1,this.celljrLength=35,this.angle=0,this.player=e.player,this.size=e.size,this.color=e.color||"blue",this.angle=e.angle||0,this.linkedCellJr=e.linkedCellJr,this.initialPosition=e.position,this.image=new Image,this.image.src=C+"celljr2.png",this.currentImagePosition=0}update(e){this.distance=k({x:this.position.x,y:this.position.y},{x:this.player.position.x,y:this.player.position.y}),this.distance<=this.celljrLength?(this.thouching=!0,this.linkedCellJr?this.linkedCellJr.touched&&(this.touched=!0):this.touched=!0):this.thouching=!1}draw(e,s){e.translate(this.position.x,this.position.y),e.drawImage(this.image,0,0,38,38,-this.size.w/2,-this.size.h/2,this.size.w,this.size.h)}restart(){this.touched=!1}}class P extends h{constructor(e){super({x:800,y:800}),this.cellsjr=[],this.completed=!1,this.nextCellJrToTouch=1,this.currentCellJrTouching=void 0,this.player=e.player;let s;for(let o=20;o>0;o--)s=new T({position:{x:Math.random()*(1e3-600)+600,y:Math.random()*(500-100)+100},angle:0,player:e.player,linkedCellJr:s,size:{w:70,h:70}}),this.cellsjr.push(s)}update(e){let s=0;for(let t=0;t<this.cellsjr.length;t++)this.cellsjr[t].touched&&s++;s==this.cellsjr.length&&(this.completed=!0);for(let t=0;t<this.cellsjr.length&&this.cellsjr[t].touched;t++)this.nextCellJrToTouch=t+1;let o=this.cellsjr.findIndex(t=>t.thouching);typeof this.currentCellJrTouching>"u"&&(this.currentCellJrTouching=0),o!=-1&&(this.currentCellJrTouching=o),this.currentCellJrTouching!=0&&this.nextCellJrToTouch!=this.currentCellJrTouching+1&&(this.currentCellJrTouching=void 0,this.player.restart(),this.cellsjr.forEach(t=>t.restart()))}draw(e,s){e.translate(this.position.x,this.position.y),e.font="35px Consolas",e.fillStyle="#000",e.fillText(`CURRENT:${this.currentCellJrTouching}`,0,0),e.fillText(`NEXT:${this.nextCellJrToTouch}`,0,50)}}const r=document.getElementById("canvas"),d=r.getContext("2d"),b={x:r.width/2,y:r.height/2};class J extends h{constructor(e={x:10,y:35}){super(e)}draw(e,s){const o=(1/s).toFixed(0);e.font="35px Consolas",e.fillStyle="#000",e.fillText(`FPS: ${o}`,this.position.x,this.position.y)}}class I extends h{constructor(e){super(e.position),this.elapsed=e.elapsed||180}draw(e,s){e.translate(this.position.x,this.position.y);const o=this.elapsed-=s;e.font="35px consolas",e.fillStyle="#000",e.fillText("Time:",-70,0),e.fillText(`${o.toFixed(1)}`,40,0)}keyboardEventDown(e){switch(e){case"Enter":this.elapsed=180;break}}}const z=i=>i.x>50&&i.x<r.width-650&&i.y>110&&i.y<r.height-100,E="src/assets/img/";class w extends h{constructor(e){super(e.position),this.gohan=e.gohan,this.position={x:this.gohan.position.x,y:this.gohan.position.y},this.size={w:43,h:14},this.speed=5,this.image=new Image,this.image.src=E+"weapon.png"}update(e){let s={x:this.position.x+this.speed*(e+.5),y:this.position.y};this.position=s}draw(e,s){e.translate(this.position.x,this.position.y),e.drawImage(this.image,0,0,43,14,-this.size.w/2,-this.size.h/2,this.size.w,this.size.h)}}const S="src/assets/img/";class v extends h{constructor(e){super(e.position),this.size=e.size,this.color=e.color||"#d62828",this.speed={x:0,y:0},this.maxSpeed=e.maxSpeed,this.initialPosition=e.position,this.image=new Image,this.image.src=S+"sprites1.png",this.imagesPosition=[0,1,2,3,4,5],this.currentImagePosition=0,this.currentYposition=0,this.timer=0,this.ammunition=[]}draw(e,s){e.translate(this.position.x,this.position.y),e.drawImage(this.image,52*this.imagesPosition[this.currentImagePosition],this.currentYposition,50,60,-this.size.w/2,-this.size.h/2,this.size.w,this.size.h)}update(e){let s={x:this.position.x+this.speed.x*(e+.5),y:this.position.y+this.speed.y*(e+.5)};z(s)&&(this.position=s),this.timer+=e,this.timer>=.1&&(this.currentImagePosition=(this.currentImagePosition+1)%1,this.timer=0)}keyboardEventDown(e){switch(e){case"ArrowRight":this.speed.x=this.maxSpeed,this.speed.y=0,this.imagesPosition=[1];break;case"ArrowLeft":this.speed.x=-this.maxSpeed,this.speed.y=0,this.imagesPosition=[2];break;case"ArrowUp":this.speed.y=-this.maxSpeed,this.speed.x=0,this.imagesPosition=[3];break;case"ArrowDown":this.speed.y=this.maxSpeed,this.speed.x=0,this.imagesPosition=[4];break;case" ":this.imagesPosition=[5],this.speed.y=0,this.speed.x=0,this.shoot(),console.log(...this.ammunition)}}keyboardEventUp(e){switch(e){case"ArrowRight":this.speed.x=0,this.speed.y=0,this.imagesPosition=[0];break;case"ArrowLeft":this.speed.x=0,this.speed.y=0,this.imagesPosition=[0];break;case"ArrowUp":this.speed.x=0,this.speed.y=0,this.imagesPosition=[0];break;case"ArrowDown":this.speed.x=0,this.speed.y=0,this.imagesPosition=[0];break;case" ":this.imagesPosition=[0],this.speed.y=0,this.speed.x=0}}restart(){}shoot(){const e=new w({gohan:this});this.ammunition.push(e)}}const y="src/assets/img/";class A{constructor(){this.image=new Image,this.image.src=y+"cellarena.png",this.title=new Image,this.title.src=y+"title.png"}draw(e){e.drawImage(this.image,-210,55),e.drawImage(this.title,250,50,600,100)}}window.onload=()=>{const i=new v({position:{x:200,y:200},size:{w:100,h:100},maxSpeed:5,angle:-90}),e=new P({player:i}),s=new J,o=new I({position:{x:b.x-50,y:35}}),t=new x,n=[new w({gohan:i})],c=new A,u=[s,...n,i,...i.ammunition,o,e,...e.cellsjr,t];let p=0;const g=a=>{let l=(a-p)/1e3;p=a,u.forEach(m=>{m.update(l)}),d.clearRect(0,0,r.width,r.height),c.draw(d),u.forEach(m=>{d.save(),m.draw(d,l),d.restore()}),window.requestAnimationFrame(g)};window.requestAnimationFrame(g),document.body.addEventListener("keydown",a=>{u.forEach(l=>{l.keyboardEventDown(a.key)})}),document.body.addEventListener("keyup",a=>{u.forEach(l=>{l.keyboardEventUp(a.key)})})};
